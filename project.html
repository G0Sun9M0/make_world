<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>😘Wordle(고성모, 서상호)</title>
    <style>
        input {
            width: 50px;
            height: 50px;
            border: 1 solid #e5e7eb;
            font-size: 35px;
            border-radius: .375rem;
            text-align: center;
            margin: 0.3px; 
        }
        body {
            text-align: center;
        }
        nav {
            text-align: left;
            margin-top: 1px;
        }
        #timer, #attempts {
            font-size: 18px;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <head>
        <h1>😘Wordle</h1>
        <hr>
    </head>
    <section id="gameSection">
        <br>
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
    </section>
    <nav>
        <div id="timer">타이머: <span id="time">00:00</span></div>
        <div id="attempts">시도 횟수: <span id="attemptCount">0</span></div>
    </nav>
    <script>
        // 미리 정의된 단어 목록
        var 단어목록 = ['sensor', 'laptop', 'animal', 'window', 'person', 'school', 'friend', 'family', 'number', 'garden'];  
        
        // 랜덤으로 답 설정
        var 답 = 단어목록[Math.floor(Math.random() * 단어목록.length)];
        console.log(답); // 테스트를 위해 콘솔에 답 출력 (필요시 삭제)

        var 시도횟수 = 0;   // 시도 횟수를 기록하는 변수

        // 타이머 설정
        var 시작시간 = new Date();
        function updateTimer() {
            var 현재시간 = new Date();
            var 경과시간 = Math.floor((현재시간 - 시작시간) / 1000);
            var 분 = String(Math.floor(경과시간 / 60)).padStart(2, '0');
            var 초 = String(경과시간 % 60).padStart(2, '0');
            document.getElementById('time').textContent = `${분}:${초}`;
        }
        setInterval(updateTimer, 1000);  // 1초마다 타이머 업데이트

        function 제출하기() {
            시도횟수++;  // 제출할 때마다 시도 횟수 증가
            document.getElementById('attemptCount').textContent = 시도횟수; // 시도 횟수 업데이트

            var input = document.querySelectorAll('.input');
            var 맞춘갯수 = 0;  // 몇 개의 글자를 맞췄는지 기록하는 변수

            // 입력한 글자를 검사
            for (let i = 0; i < 6; i++) {
                if (input[i].value === 답[i]) {
                    input[i].style.background = '#22c55e';
                    맞춘갯수++;
                } else if (답.includes(input[i].value)) {
                    input[i].style.background = '#eab308';
                } else {
                    input[i].style.background = '#6b7280';
                    input[i].style.color= '#ffffff';
                }
                input[i].classList.remove('input');
            }

            // 모든 글자를 맞춘 경우 (6개의 글자가 모두 초록색인 경우)
            if (맞춘갯수 === 6) {
                alert(`성공! ${시도횟수}번 만에 맞췄습니다.`);
                // 다시 시작 버튼 생성
                var resetButton = document.createElement('button');
                resetButton.textContent = '다시 시작';
                resetButton.onclick = resetGame;  // 버튼 클릭 시 resetGame 함수 호출
                document.body.appendChild(resetButton);
                return;  // 성공하면 추가 입력을 받지 않고 종료
            }

            // 새로운 입력 칸 생성 (6개)
            
            var template = `
            <div style="margin-top: 5px;">  <!-- 위와 여백을 생성 -->
                    <input class="input" maxlength="1">
                    <input class="input" maxlength="1">
                    <input class="input" maxlength="1">
                    <input class="input" maxlength="1">
                    <input class="input" maxlength="1">
                    <input class="input" maxlength="1">
                </div>`;
            document.querySelector('body').insertAdjacentHTML('beforeend', template);

            // 새로 생성된 입력칸에도 알파벳 필터 적용
            setInputFilter();
            setAutoTab();
        }

        // 알파벳만 입력 가능하도록 필터링
        function setInputFilter() {
            var inputs = document.querySelectorAll('.input');
            inputs.forEach(function(input) {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/[^a-zA-Z]/g, '').toLowerCase();
                });
            });
        }

        // 입력이 완료되면 자동으로 다음 입력칸으로 포커스 이동
        function setAutoTab() {
            var inputs = document.querySelectorAll('.input');
            inputs.forEach(function(input, index) {
                input.addEventListener('input', function() {
                    if (this.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                });

                // Backspace로 이전 칸으로 포커스 이동
                input.addEventListener('keydown', function(event) {
                    if (event.key === 'Backspace' && input.value === '' && index > 0) {
                        inputs[index - 1].focus();  // 이전 칸으로 포커스 이동
                    }
                });
            });
        }

        function resetGame() {
            location.reload();  // 페이지 새로고침
        }

        // 엔터 키로 제출하기
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // 엔터 키 기본 동작 차단
                제출하기();

                // 첫 번째 입력 칸에 포커스를 맞춤
                var inputs = document.querySelectorAll('.input');
                if (inputs.length > 0) {
                    inputs[0].focus();  // 새로 생성된 줄의 첫 번째 칸에 포커스
                }
            }
        });

        // 초기 입력 필터 및 자동탭 설정
        setInputFilter();
        setAutoTab();
    </script>
</body>
</html>