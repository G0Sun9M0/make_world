<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ˜˜Wordle(ê³ ì„±ëª¨, ì„œìƒí˜¸)</title>
    <style>
        input {
            width: 50px;
            height: 50px;
            border: 1 solid #e5e7eb;
            font-size: 35px;
            border-radius: .375rem;
            text-align: center;
            margin: 0.3px;
        }

        body {
            text-align: center;
        }

        nav {
            margin-top: 1px;
            font-size: 18px;
        }

        #timer,
        #attempts,
        #stage,
        #timeLimit {
            font-size: 18px;
            margin-top: 10px;
        }

        progress {
            width: 100%;
            /* í”„ë¡œê·¸ë ˆìŠ¤ë°”ì˜ ë„ˆë¹„ */
            height: 20px;
            /* í”„ë¡œê·¸ë ˆìŠ¤ë°”ì˜ ë†’ì´ */
            background-color: green;
        }
    </style>
</head>

<body>
    <h1>ğŸ˜˜Wordle</h1>
    <hr>
    <nav>
        <div>í˜„ì¬ ë‹¨ê³„: <span id="currentStage">1</span> / 6</div>
        <div id="timer">í”Œë ˆì´ ì‹œê°„: <span id="time">00:00</span></div>
        <div id="timeLimit">
            ë‚¨ì€ ì‹œê°„:
            <progress id="progressBar" value="100" max="100"></progress>
        </div>
        <div id="attempts">ì‹œë„ íšŸìˆ˜: <span id="attemptCount">0</span> / <span id="maxAttempts">ë¬´ì œí•œ</span></div>
    </nav>

    <section id="gameSection">
        <br>
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
        <input class="input" maxlength="1">
    </section>

    <script>
        var ë‹¨ì–´ëª©ë¡ = ['sensor', 'laptop', 'animal', 'window', 'person', 'school', 'friend', 'family', 'number', 'garden'];
        var ì‚¬ìš©ëœë‹¨ì–´ = [];
        var ë‹¨ê³„ = 1;
        var ìµœëŒ€ë‹¨ê³„ = 6;
        var ë‹µ;
        var ì‹œë„íšŸìˆ˜ = 0;
        var ìµœëŒ€ì‹œë„ = Infinity;  // ì²« ë‹¨ê³„ì—ì„œëŠ” ë¬´ì œí•œ
        var ì œí•œì‹œê°„ = 180;  // ì²« ë‹¨ê³„ëŠ” 3ë¶„(180ì´ˆ)
        var íƒ€ì´ë¨¸ì‘ë™ì¤‘ = false;
        var ì‹œì‘ì‹œê°„;
        var ì œí•œì‹œê°„íƒ€ì´ë¨¸;

        // ê° ë‹¨ê³„ë³„ ì œí•œ ì‹œê°„ê³¼ ì‹œë„ íšŸìˆ˜ ì„¤ì •
        var ë‹¨ê³„ì •ë³´ = [
            {ì‹œê°„: 180, ì‹œë„íšŸìˆ˜: Infinity}, // 1ë‹¨ê³„
            {ì‹œê°„: 150, ì‹œë„íšŸìˆ˜: 15},      // 2ë‹¨ê³„
            {ì‹œê°„: 120, ì‹œë„íšŸìˆ˜: 13},      // 3ë‹¨ê³„
            {ì‹œê°„: 90, ì‹œë„íšŸìˆ˜: 11},      // 4ë‹¨ê³„
            {ì‹œê°„: 60, ì‹œë„íšŸìˆ˜: 8},       // 5ë‹¨ê³„
            {ì‹œê°„: 30, ì‹œë„íšŸìˆ˜: 6}        // 6ë‹¨ê³„
        ];

        function ìƒˆë‹¨ì–´() {
            var í›„ë³´ë‹¨ì–´ëª©ë¡ = ë‹¨ì–´ëª©ë¡.filter(word => !ì‚¬ìš©ëœë‹¨ì–´.includes(word));
            ë‹µ = í›„ë³´ë‹¨ì–´ëª©ë¡[Math.floor(Math.random() * í›„ë³´ë‹¨ì–´ëª©ë¡.length)];
            ì‚¬ìš©ëœë‹¨ì–´.push(ë‹µ);
            console.log(ë‹µ);
        }

        function updateTimer() {
            var í˜„ì¬ì‹œê°„ = new Date();
            var ê²½ê³¼ì‹œê°„ = Math.floor((í˜„ì¬ì‹œê°„ - ì‹œì‘ì‹œê°„) / 1000);
            var ë¶„ = String(Math.floor(ê²½ê³¼ì‹œê°„ / 60)).padStart(2, '0');
            var ì´ˆ = String(ê²½ê³¼ì‹œê°„ % 60).padStart(2, '0');
            document.getElementById('time').textContent = `${ë¶„}:${ì´ˆ}`;
        }

        function startTimeLimitTimer() {
            var ë‚¨ì€ì‹œê°„ = ì œí•œì‹œê°„;
            var progressBar = document.getElementById('progressBar');
            progressBar.max = ì œí•œì‹œê°„;  // ìµœëŒ€ê°’ì„ ì œí•œì‹œê°„ìœ¼ë¡œ ì„¤ì •
            progressBar.value = ì œí•œì‹œê°„;  // ì´ˆê¸°ê°’ì€ ì œí•œì‹œê°„ìœ¼ë¡œ ì„¤ì •

            ì œí•œì‹œê°„íƒ€ì´ë¨¸ = setInterval(function () {
                ë‚¨ì€ì‹œê°„--;
                progressBar.value = ë‚¨ì€ì‹œê°„;  // í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸

                if (ë‚¨ì€ì‹œê°„ <= 0) {
                    clearInterval(ì œí•œì‹œê°„íƒ€ì´ë¨¸);
                    alert("ì‹œê°„ ì´ˆê³¼! ê²Œì„ì´ ì¢…ë£Œë©ë‹ˆë‹¤.");
                    resetGame();
                }
            }, 1000);
        }

        function ì œì¶œí•˜ê¸°() {
            if (ì‹œë„íšŸìˆ˜ >= ìµœëŒ€ì‹œë„) {
                alert(`ì‹œë„ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤!`);
                resetGame();
                return;
            }

            ì‹œë„íšŸìˆ˜++;
            document.getElementById('attemptCount').textContent = ì‹œë„íšŸìˆ˜;

            var input = document.querySelectorAll('.input');
            var ë§ì¶˜ê°¯ìˆ˜ = 0;

            for (let i = 0; i < 6; i++) {
                if (input[i].value === ë‹µ[i]) {
                    input[i].style.background = '#22c55e';
                    ë§ì¶˜ê°¯ìˆ˜++;
                } else if (ë‹µ.includes(input[i].value)) {
                    input[i].style.background = '#eab308';
                } else {
                    input[i].style.background = '#6b7280';
                    input[i].style.color = '#ffffff';
                }
                input[i].classList.remove('input');
            }

            if (ë§ì¶˜ê°¯ìˆ˜ === 6) {
                alert(`ì„±ê³µ! ${ì‹œë„íšŸìˆ˜}ë²ˆ ë§Œì— ë§ì·„ìŠµë‹ˆë‹¤.`);

                if (ë‹¨ê³„ < ìµœëŒ€ë‹¨ê³„) {
                    ë‹¨ê³„++;
                    ë‹¤ìŒë‹¨ê³„();
                } else {
                    ì™„ë£Œ();
                }
                return;
            }

            var template = `
            <div style="margin-top: 5px;">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
            </div>`;
            document.querySelector('#gameSection').insertAdjacentHTML('beforeend', template);
            setInputFilter();
            setAutoTab();
        }

        function setInputFilter() {
            var inputs = document.querySelectorAll('.input');
            inputs.forEach(function (input) {
                input.addEventListener('input', function () {
                    this.value = this.value.replace(/[^a-zA-Z]/g, '').toLowerCase();
                });
            });
        }

        function setAutoTab() {
            var inputs = document.querySelectorAll('.input');
            inputs.forEach(function (input, index) {
                input.addEventListener('input', function () {
                    if (!íƒ€ì´ë¨¸ì‘ë™ì¤‘ && this.value !== '') {
                        ì‹œì‘íƒ€ì´ë¨¸();  // ì²« ì…ë ¥ ì‹œ ìŠ¤í†±ì›Œì¹˜ ì‹œì‘
                        startTimeLimitTimer();  // ì œí•œ ì‹œê°„ íƒ€ì´ë¨¸ ì‹œì‘
                    }
                    if (this.value.length === 1 && index < inputs.length - 1) {
                        inputs[index + 1].focus();
                    }
                });
                input.addEventListener('keydown', function (event) {
                    if (event.key === 'Backspace' && input.value === '' && index > 0) {
                        inputs[index - 1].focus();
                    }
                });
            });
        }

        function ì‹œì‘íƒ€ì´ë¨¸() {
            if (!íƒ€ì´ë¨¸ì‘ë™ì¤‘) {
                ì‹œì‘ì‹œê°„ = new Date();
                íƒ€ì´ë¨¸ì‘ë™ì¤‘ = true;
                setInterval(updateTimer, 1000);  // ìŠ¤í†±ì›Œì¹˜ ì‘ë™
            }
        }

        function resetGame() {
            location.reload();
        }

        function ë‹¤ìŒë‹¨ê³„() {
            clearInterval(ì œí•œì‹œê°„íƒ€ì´ë¨¸);  // ì´ì „ ë‹¨ê³„ì˜ ì œí•œ ì‹œê°„ íƒ€ì´ë¨¸ ì¢…ë£Œ

            // ìƒˆë¡œìš´ ë‹¨ì–´ë¡œ ì„¤ì •
            ìƒˆë‹¨ì–´();

            // ë‹¨ê³„ ì„¤ì •
            var currentInfo = ë‹¨ê³„ì •ë³´[ë‹¨ê³„ - 1];
            ì œí•œì‹œê°„ = currentInfo.ì‹œê°„;
            ìµœëŒ€ì‹œë„ = currentInfo.ì‹œë„íšŸìˆ˜;

            // ë‹¨ê³„ì™€ ì œí•œì‹œê°„, ì‹œë„ íšŸìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById('currentStage').textContent = ë‹¨ê³„;
            document.getElementById('progressBar').max = ì œí•œì‹œê°„;  // ì œí•œì‹œê°„ì„ í”„ë¡œê·¸ë ˆìŠ¤ë°”ì— ë°˜ì˜
            document.getElementById('progressBar').value = ì œí•œì‹œê°„;  // í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì´ˆê¸°í™”
            document.getElementById('maxAttempts').textContent = ìµœëŒ€ì‹œë„ === Infinity ? 'ë¬´ì œí•œ' : ìµœëŒ€ì‹œë„;
            ì‹œë„íšŸìˆ˜ = 0;
            document.getElementById('attemptCount').textContent = ì‹œë„íšŸìˆ˜;

            // ê¸°ì¡´ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('gameSection').innerHTML = `
                <br>
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">
                <input class="input" maxlength="1">`;

            setInputFilter();
            setAutoTab();

            startTimeLimitTimer();
        }


        function ì™„ë£Œ() {
            document.body.innerHTML = `
                <h1>ê²Œì„ ì™„ë£Œ</h1>
                <p>ëª¨ë“  ë‹¨ê³„ë¥¼ ì„±ê³µí–ˆìŠµë‹ˆë‹¤!</p>
                <button onclick="resetGame()">ë‹¤ì‹œ ì‹œì‘</button>`;

            clearInterval(ì œí•œì‹œê°„íƒ€ì´ë¨¸);
        }

        document.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                ì œì¶œí•˜ê¸°();
                var inputs = document.querySelectorAll('.input');
                if (inputs.length > 0) {
                    inputs[0].focus();
                }
            }
        });

        ìƒˆë‹¨ì–´();  // ê²Œì„ ì‹œì‘ ì‹œ ë‹¨ì–´ ì„¤ì •
        setInputFilter();
        setAutoTab();
    </script>
</body>

</html>